<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>ZigChatBot</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" type="image/png" href="data:image/png;base64,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" />
  <style>
    body {
      font-family: sans-serif;
      background: #121212;
      color: #fff;
      margin: 0;
      padding: 0;
      height: 100vh;
      overflow: hidden;
      transition: background-color 0.3s;
    }

    .light {
      background: #f5f5f5;
      color: #000;
    }

    .chat-container {
      display: flex;
      flex-direction: column;
      height: 100%;
      padding: 20px;
    }

    .messages {
      flex: 1;
      background: #1e1e1e;
      padding: 10px;
      border-radius: 10px;
      overflow-y: auto;
    }

    .light .messages {
      background: #fff;
      color: #000;
    }

    .input-area {
      display: flex;
      margin-top: 10px;
    }

    input {
      flex: 1;
      padding: 10px;
      font-size: 16px;
      border-radius: 5px;
      border: 1px solid #333;
    }

    .light input {
      border-color: #ddd;
    }

    button {
      cursor: pointer;
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 5px;
      background: #333;
      color: #fff;
    }

    .light button {
      background: #ddd;
      color: #000;
    }

    button:hover {
      opacity: 0.9;
    }

    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 10px;
    }

    .buttons button {
      flex: 1 1 20%;
      min-width: 80px;
    }

    .typing-effect {
      display: inline-block;
      white-space: pre;
    }

    .cursor {
      display: inline-block;
      background: currentColor;
      width: 2px;
      animation: blink 0.7s step-end infinite;
    }

    @keyframes blink {
      50% {
        opacity: 0;
      }
    }

    .theme-toggle {
      position: fixed;
      top: 20px;
      right: 20px;
      width: 35px;
      height: 35px;
      background: #333;
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .light .theme-toggle {
      background: #ddd;
    }

    .theme-toggle svg {
      width: 20px;
      height: 20px;
      fill: currentColor;
      display: none;
    }

    .theme-toggle .moon {
      display: inline-block;
    }

    .light .theme-toggle .moon {
      display: none;
    }

    .light .theme-toggle .sun {
      display: inline-block;
    }

    #swapBox {
      display: none;
      background: #222;
      padding: 10px;
      border-radius: 8px;
      margin-top: 10px;
    }

    .light #swapBox {
      background: #eee;
      color: #000;
    }

    #swapBox select,
    #swapBox input {
      width: 100%;
      margin: 5px 0;
      padding: 8px;
      border-radius: 4px;
      border: none;
    }
  </style>
</head>

<body>
  <div class="chat-container">
    <h2>üëã ZigChatBot</h2>
    <div class="messages" id="messages"></div>
    <div class="input-area">
      <input id="userInput" placeholder="Type message..." />
      <button onclick="sendMessage()">Send</button>
    </div>
    <div style="margin:10px 0;">
      <button id="connectBtn" onclick="connectWallet()">üîó Connect Wallet</button>
      <span id="walletAddr" style="margin-left:10px;"></span>
      <button id="disconnectBtn" onclick="disconnectWallet()" style="display:none;">‚ùå Disconnect</button>
    </div>
    <div id="swapBox">
      <label>From:</label>
      <select id="fromToken">
        <option>ZIG</option>
        <option>ORO</option>
        <option>BEE</option>
        <option>STZIG</option>
        <option>FOMOFEAST</option>
        <option>PUMP</option>
        <option>CULTCOIN</option>
        <option>NFA</option>
        <option>ZMZIG</option>
        <option>ZIGRWA</option><option>APEX</option><option>ZWA</option><option>RWA</option>
        <option>SHIT</option><option>MOON</option><option>FART</option><option>ALPHA</option><option>ZELLA</option><option>ZMWORLD</option>
        <option>WIZZ</option><option>PONMUDI</option><option>TATTOO</option><option>KARELA</option>
      </select>
      <label>To:</label>
      <select id="toToken">
        <option>ZIG</option>
        <option>ORO</option>
        <option>BEE</option>
        <option>STZIG</option>
        <option>FOMOFEAST</option>
        <option>PUMP</option>
        <option>CULTCOIN</option>
        <option>NFA</option>
        <option>ZMZIG</option>
        <option>ZIGRWA</option><option>APEX</option><option>ZWA</option><option>RWA</option>
        <option>SHIT</option><option>MOON</option><option>FART</option><option>ALPHA</option><option>ZELLA</option><option>ZMWORLD</option>
        <option>WIZZ</option><option>PONMUDI</option><option>TATTOO</option><option>KARELA</option>
      </select>
      <label>Amount:</label>
      <input type="number" id="swapAmount" placeholder="e.g., 0.01" />
      <button onclick="submitSwap()">üöÄ Swap Now</button>
    </div>
    <div class="buttons">

      <button onclick="quick('quote')">üí¨ Quote</button>
      <!-- <button onclick="quick('emoji')">üé≤ Emoji</button> -->
      <button onclick="quick('learn')">üìö Learn</button>
      <button onclick="quick('real swap')">üîÑ Swap</button>
      <button onclick="quick('time')">‚è∞ Time</button>
      <button onclick="quick('stats')">üìä Stats</button>
      <!-- <button onclick="quick('history')">üßæ History</button> -->
    </div>
  </div>

  <div class="theme-toggle" onclick="toggleTheme()">
    <svg class="moon" viewBox="0 0 24 24">
      <path d="M21 12.79A9 9 0 0112.21 3a7 7 0 000 14A9 9 0 0121 12.79z" />
    </svg>
    <svg class="sun" viewBox="0 0 24 24">
      <circle cx="12" cy="12" r="5" />
      <line x1="12" y1="1" x2="12" y2="3" />
      <line x1="12" y1="21" x2="12" y2="23" />
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64" />
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78" />
      <line x1="1" y1="12" x2="3" y2="12" />
      <line x1="21" y1="12" x2="23" y2="12" />
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36" />
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22" />
    </svg>
  </div>
  <div id="loader" style="
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 18px;
    background: rgba(0,0,0,0.7);
    padding: 20px;
    border-radius: 10px;
    z-index: 9999;">
    üîÑ Processing transaction...
  </div>

  <!-- <script src="https://cdn.jsdelivr.net/npm/@cosmjs/stargate@0.36.2/build/stargate.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@cosmjs/cosmwasm-stargate@0.36.2/build/cosmwasm-stargate.min.js"></script>
   -->
<div id="statsBox" style="white-space: pre-line; margin-top: 15px; font-size: 16px;"></div>

<script src="/socket.io/socket.io.js"></script>
<script type="module">
  import { SigningCosmWasmClient } from "https://esm.run/@cosmjs/cosmwasm-stargate";
  window.SigningCosmWasmClient = SigningCosmWasmClient;
</script>

<script>
  const input = document.getElementById("userInput");
  const messages = document.getElementById("messages");
  const sendS = new Audio("./keyboard.mp3");
  const replyS = new Audio("./keyboard.mp3");
  const typeS = new Audio("./typing8s.mp3");
  typeS.loop = false;

  const socket = io();

  socket.on("connect", () => {
    console.log("‚úÖ Connected to real-time stats");
  });

  socket.on("statsUpdated", (data) => {
    const now = Date.now();
    const cutoff = now - 24 * 60 * 60 * 1000;
    const visits = data.visits.filter(t => t > cutoff).length;
    const swaps = data.swaps.filter(t => t > cutoff).length;
    document.getElementById("statsBox").innerText =
      `üìä Stats (Last 24 hrs):\nVisits: ${visits}\nSwaps: ${swaps}`;
  });

  function appendMessage(from, text, isTyping = false) {
    const div = document.createElement("div");
    div.innerHTML = `<strong>${from}:</strong> <span class="typing-effect">${isTyping ? '<span class="cursor"></span>' : text}</span>`;
    messages.appendChild(div);
    messages.scrollTop = messages.scrollHeight;
    return div.querySelector(".typing-effect");
  }

  function typeMessage(span, text) {
    let i = 0;
    typeS.pause();
    typeS.currentTime = 0;
    typeS.play().catch(() => {});
    const interval = setInterval(() => {
      if (i < text.length) {
        span.innerHTML = text.slice(0, i + 1) + '<span class="cursor"></span>';
        messages.scrollTop = messages.scrollHeight;
        i++;
      } else {
        clearInterval(interval);
        typeS.pause();
        typeS.currentTime = 0;
        span.innerText = text;
        replyS.currentTime = 0;
        replyS.play().catch(() => {});
      }
    }, 60);
  }

  function sendMessage() {
    const msg = input.value.trim();
    if (!msg) return;
    appendMessage("You", msg);
    sendS.currentTime = 0;
    sendS.play().catch(() => {});
    input.value = "";
    const botSpan = appendMessage("Bot", "", true);

    try {
      fetch("/chat", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ message: msg })
      })
        .then(r => r.json())
        .then(d => setTimeout(() => typeMessage(botSpan, d.reply), 200))
        .catch(() => {
          typeS.pause();
          typeS.currentTime = 0;
          appendMessage("Bot", "‚ùå Error occurred.");
        });
    } catch (err) {
      appendMessage("Bot", "‚ùå Error sending message.");
    }
  }

  let walletAddress = "";
  let chainId = "zig-test-2";

  async function connectWallet() {
    if (!window.keplr) {
      alert("Please install Keplr Wallet extension!");
      return;
    }
    try {
      await window.keplr.enable(chainId);
      const offlineSigner = window.getOfflineSigner(chainId);
      const accounts = await offlineSigner.getAccounts();
      walletAddress = accounts[0].address;
      document.getElementById("walletAddr").innerText = "Connected: " + walletAddress;
      document.getElementById("connectBtn").style.display = "none";
      document.getElementById("disconnectBtn").style.display = "inline-block";

      // ‚úÖ Trigger /visit again after wallet connect
      await fetch("/visit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({})
      });
    } catch (e) {
      alert("Wallet connection failed: " + e.message);
    }
  }



    socket.on("connect", () => {
      console.log("‚úÖ Connected to real-time stats");
    });

    socket.on("statsUpdated", (data) => {
      const now = Date.now();
      const cutoff = now - 24 * 60 * 60 * 1000;
      const visits = data.visits.filter(t => t > cutoff).length;
      const swaps = data.swaps.filter(t => t > cutoff).length;
      document.getElementById("statsBox").innerText = `üìä Stats (Last 24 hrs):\nVisits: ${visits}\nSwaps: ${swaps}`;
      localStorage.setItem("swapStats", JSON.stringify(data));
    });
    function disconnectWallet() {
      walletAddress = "";
      document.getElementById("walletAddr").innerText = "";
      document.getElementById("connectBtn").style.display = "inline-block";
      document.getElementById("disconnectBtn").style.display = "none";
    }

    function quick(txt) {
      input.value = txt;
      if (txt.includes("swap")) {
        document.getElementById("swapBox").style.display = "block";
      } else {
        document.getElementById("swapBox").style.display = "none";
        sendMessage();
      }
    }

    function submitSwap() {
      const from = document.getElementById("fromToken").value;
      const to = document.getElementById("toToken").value;
      const amt = document.getElementById("swapAmount").value;
      if (!walletAddress) {
        alert("Please connect your wallet first!");
        return;
      }
      if (!window.SigningCosmWasmClient) {
        alert("CosmJS not loaded. Please refresh the page.");
        return;
      }
      input.value = `swap from ${from} to ${to} amount ${amt} address ${walletAddress}`;
      document.getElementById("swapBox").style.display = "none";
      sendMessage();
      swapWithKeplr(from, to, amt);
    }

    async function swapWithKeplr(from, to, amt) {
      const loader = document.getElementById("loader");
      loader.style.display = "block"; // Show loader

      if (!window.keplr) {
        loader.style.display = "none";
        appendMessage("Bot", "‚ùå Keplr not found.");
        return;
      }
      if (!window.SigningCosmWasmClient) {
        loader.style.display = "none";
        appendMessage("Bot", "‚ùå CosmJS not found. Check your script src.");
        return;
      }
      try {
        await window.keplr.enable(chainId);
        const offlineSigner = window.getOfflineSigner(chainId);
        const rpc = "https://public-zigchain-testnet-rpc.numia.xyz/";
        const client = await window.SigningCosmWasmClient.connectWithSigner(rpc, offlineSigner, {
          gasPrice: "0.025uzig"
        });

     const tokenMap = {
  ZIG: "uzig",
  ORO: "zig15jqg0hmp9n06q0as7uk3x9xkwr9k3r7yh4ww2uc0hek8zlryrgmsamk4qg",
  BEE: "zig1r50m5lafnmctat4xpvwdpzqndynlxt2skhr4fhzh76u0qar2y9hqu74u5h",
  STZIG: "zig19zqxslng99gw98ku3dyqaqy0c809kwssw7nzhea9x40jwxjugqvs5xaghj",
  FOMOFEAST: "zig1unc0549k2f0d7mjjyfm94fuz2x53wrx3px0pr55va27grdgmspcqsp4692",
  PUMP: "zig1k0728vraxvf7gn3dptlnlw5etrwlfd2yagf5u9jnsj9x7wpskds9xhjya",
  CULTCOIN: "zig1j55nw46crxkm03fjdf3cqx3py5cd32jny685x9c3gftfdt2xlvjs63znce",
  NFA: "zig1dye3zfsn83jmnxqdplkfmelyszhkve9ae6jfxf5mzgqnuylr0sdq8ng9tv",
  ZMZIG: "zig15meu4rk66v0wlp59tuewng4rpfvepagpfd8uq9w59rd77ce56dnqftmxn2",
  ZIGRWA: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.rwaonzig",
  APEX: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.apexgroup",
  ZWA: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.zigwa", 
  RWA : "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.rwassets",
  SHIT: "coin.zig10xvc3tkqrdyym6ep9lrt5005mrwvw6rml66qv7jxwnzlpqfmw7ksq7n7nm.shitcoin",
  MOON: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.moon",
  FART: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.fartcoin",
  ALPHA: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.alpha",
  ZELLA : "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.zella",
  ZMWORLD: "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.zmworld",
  WIZZ : "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.wizz",
  PONMUDI : "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.pomi",
  TATTOO : "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.tattoo",
  KERALA : "coin.zig1zpnw5dtzzttmgtdjgtywt08wnlyyskpuupy3cfw8mytlslx54j9sgz6w4n.kera",
};
const pairContracts = {
  // Native ZIG to CW20
  "ZIG:BEE": "zig1r50m5lafnmctat4xpvwdpzqndynlxt2skhr4fhzh76u0qar2y9hqu74u5h",
  "ZIG:ORO": "zig15jqg0hmp9n06q0as7uk3x9xkwr9k3r7yh4ww2uc0hek8zlryrgmsamk4qg",
  "ZIG:NFA": "zig1dye3zfsn83jmnxqdplkfmelyszhkve9ae6jfxf5mzgqnuylr0sdq8ng9tv",
 "ZIG:ZMZIG": "zig15meu4rk66v0wlp59tuewng4rpfvepagpfd8uq9w59rd77ce56dnqftmxn2",
  "ZIG:STIG": "zig19zqxslng99gw98ku3dyqaqy0c809kwssw7nzhea9x40jwxjugqvs5xaghj",
  "ZIG:FOMOFEAST": "zig1unc0549k2f0d7mjjyfm94fuz2x53wrx3px0pr55va27grdgmspcqsp4692",
  "ZIG:PUMP": "zig1k0728vraxvf7gn3dptlnlw5etrwlfd2yagf5u9jnsj9x7wpskds9xhjya",
  "ZIG:CULTCOIN": "zig1j55nw46crxkm03fjdf3cqx3py5cd32jny685x9c3gftfdt2xlvjs63znce",
  "ZIG:ZIGRWA": "zig1sk7fmq4js7j24rttgflu9jwv4s7yzduzyln85p5mphxunn22f4psna95u6",
  "ZIG:RWA" : "zig18ptvdr5em20mvezp2rlqw098e675r7lzl78fux9kaz026er7wf6swvzc4q",
  "ZIG:APEX" : "zig1e5ngrvpruhfuqyjsm3l3hrxmpzernrzmtgzx5cz3s0p7dw60dmgsfuav8v",
  "ZIG:ZWA" : "zig13jk72eklk6m7nsg623qqdgnkwz5uujyf8p6dru2dgye6jjtet57q7t0tu7",
  "ZIG:SHIT" : "zig10fl5cjufjfpdhr9x65a8g5cnnj9lcre223fx04hjychukjs6ardqa580ae",
  "ZIG:MOON" : "zig1eqggyhjj23cl3r7j5apnyg7mxrm639zeh46xq24eeccdh922mxjqq0kd4h",
  "ZIG:FART" : "zig16hgeu44j5vezxavgjkgqsl2wy77223kqyu8al0vq73te0uh7374q33mqjg",
  "ZIG:ALPHA" : "zig1c0m3myg8gr7shg4dra7cprvkha5serfsduet2td6zdj9ern82w4qwx06vc",
  "ZIG:ZELLA" : "zig1c79ty07xnxq3dr9m9mcfnuejzym5uzwgj57600jyyzvy7vkrmd7sxvph7r",
  "ZIG:ZMWORLD": "zig123pzd2pmqa8qreny4ac3q3t6h0grq3q95gxs8dh3dfyylygkm50qfqp8n2",
  "ZIG:WIZZ": "zig1ej9x8me3fhtm9hwvu6tngklxp5hqekg3d893vf6ewevlvz55a99qs7mcl0",
  "ZIG:PONMUDI" : "zig14e2744ejgml7sjgmchlzcyujchmjjkmv6nwy90vfxldd7fhhjtnqud0x9y",
  "ZIG:TATTOO" : "zig1ymjmap5rj3pg2lye654923df3ccz6zgcuku6t5a4nglh6ed42zsqmht0lf",
  "ZIG:KERALA" : "zig1qk4a6qlkfq07nyn9dhv28kpknmfpl2xa9tp7shlqaqtuu3r2kyrstlqfyq",
};
        const fromDenom = tokenMap[from];
        const toDenom = tokenMap[to];
        const amount = Math.floor(parseFloat(amt) * 1_000_000).toString();
        const pairKey = `${from}:${to}`;
        const CONTRACT_ADDRESS = pairContracts[pairKey];
        if (!CONTRACT_ADDRESS) throw new Error("No swap contract for this pair");

        const msgExecute = {
          swap: {
            offer_asset: {
              amount,
              info: fromDenom.startsWith("zig1")
                ? { token: { contract_addr: fromDenom } }
                : { native_token: { denom: fromDenom } },
            },
            ask_asset_info: toDenom.startsWith("zig1")
              ? { token: { contract_addr: toDenom } }
              : { native_token: { denom: toDenom } },
          },
        };

        const result = await client.execute(
          walletAddress,
          CONTRACT_ADDRESS,
          msgExecute,
          {
            amount: [{ denom: "uzig", amount: "5000" }],
            gas: "2000000",
          },
          undefined,
          fromDenom.startsWith("zig1") ? [] : [{ denom: fromDenom, amount }]
        );

        loader.style.display = "none"; // ‚úÖ Hide loader on success

        const explorerUrl = `https://zigscan.org/tx/${result.transactionHash}`;
        appendMessage(
          "Bot",
          `‚úÖ Swap successful!\nüîÅ ${from} ‚Üí ${to}\nüîó <a href="${explorerUrl}" target="_blank" style="color:#4e9afc;">View on Explorer</a>`
        );
      } catch (err) {
        loader.style.display = "none"; // ‚ùå Hide loader on failure too
        appendMessage("Bot", `‚ùå Swap failed: ${err.message}`);
      }
    }

    function toggleTheme() {
      document.body.classList.toggle("light");
    }

    input.addEventListener("keydown", e => {
      if (e.key === "Enter") sendMessage();
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      fetch("/visit", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({})
      }).catch(err => console.error("Visit track failed", err));
    });
    </script>

</body>

</html>
